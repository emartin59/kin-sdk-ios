language: swift
osx_image: xcode10.1
xcode_project: StellarKit.xcodeproj
xcode_scheme: StellarKit
xcode_sdk: iphonesimulator8.4

env:
- TEST_MATRIX=build
- TEST_MATRIX=test

script:
  - |
    if [ $TEST_MATRIX == "build" ]; then 
      xcodebuild -workspace KinSampleApp/KinSampleApp.xcodeproj/project.xcworkspace -scheme KinUtil -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO;
      xcodebuild -workspace KinSampleApp/KinSampleApp.xcodeproj/project.xcworkspace -scheme KinSDK -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO;
      xcodebuild -workspace KinSampleApp/KinSampleApp.xcodeproj/project.xcworkspace -scheme KinSampleApp -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO;
    fi
  - |
    if [ $TEST_MATRIX == "test" ]; then
      xcodebuild test -workspace KinSampleApp/KinSampleApp.xcodeproj/project.xcworkspace -scheme KinSDK -destination 'platform=iOS Simulator,name=iPhone 8 Plus';
    fi

after_success:
  - bash <(curl -s https://codecov.io/bash)